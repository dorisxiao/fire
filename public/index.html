<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>宜宾消防 接口文档</title>
    <link href="/zui/css/zui.min.css" rel="stylesheet">
    <style>
        .gb {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            min-width: 1000px;
            z-index: -10;
            zoom: 1;
            background-color: #fff;
            background: url('/res/bg.jpg');
            background-repeat: no-repeat;
            background-size: cover;
            -webkit-background-size: cover;
            -o-background-size: cover;
            background-position: center 0;
        }
    </style>
</head>

<body style="overflow-x:hidden">
    <div class="gb"></div>
    <header id="header" class="bg-primary">
        <div class="navbar navbar-inverse navbar-top" id="navbar" role="banner">
            <div class="navbar-header">
                <div class="navbar-brand"><span class="path-zui-36">
                        <i class="path-1"></i>
                        <iclass="path-2"></i>
                    </span>
                    <span class="brand-title">F 接口文档</span>
                </div>
            </div>
        </div>
    </header>
    <div class="row panel load-indicator loading" id="docs" data-loading="正在请求数据..."
        style="border: 0px;box-shadow: none;background-color: rgba(255, 255, 255, 0.4);">
        <div v-if="docs" class="col-md-3">
            <nav class="menu" style="margin-left:10px;margin-right: 10px;">
                <ul id="treeMenu" class="tree tree-menu" data-animate="true">
                    <li v-on:click="itemClick(doc)" v-for="doc in docs"
                        v-bind:class="{open:(title == doc.title?'open':'')}">
                        <i class="list-toggle icon"></i>
                        <a href="#"><i class="icon icon-cubes"></i>{{doc.title}}</a>
                        <ul>
                            <li v-for="item in doc.array"
                                v-bind:class="{active:(selected.title == item.title?'active':'')}">
                                <a href="#" v-on:click="selectApi(doc.title,item)"><i
                                        class="icon icon-code"></i>{{item.api}}<br />
                                    <span style="font-size: smaller;">{{item.title}}</span></a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </nav>
            <div class="panel panel-primary" style="margin: 10px;">
                <div class="panel-heading">通用错误列表</div>
                <div class="panel-body" style="padding: 0">
                    <table class="table table-hover" style="padding: 0;margin-bottom:0px">
                        <thead>
                            <tr>
                                <th>返回值</th>
                                <th>说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>0</td>
                                <td>接口正常返回</td>
                            </tr>
                            <tr>
                                <td>65535</td>
                                <td>内部程序异常</td>
                            </tr>
                            <tr>
                                <td>65280</td>
                                <td>权限相关错误</td>
                            </tr>
                            <tr>
                                <td>65281</td>
                                <td>参数缺失错误</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="panel panel-primary" style="margin: 10px;">
                <div class="panel-heading">自定义错误列表</div>
                <div class="panel-body" style="padding: 0">
                    <table class="table table-hover" style="padding: 0;margin-bottom:0px">
                        <thead>
                            <tr>
                                <th>返回值</th>
                                <th>说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="p in codes">
                                <td v-if="p.code!=0">{{p.code}}</td>
                                <td v-if="p.code!=0">{{p.message}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="panel panel-danger" style="margin: 10px;">
                <div class="panel-heading">数据压缩<br />(注平台接口返回压缩后的结果)<br />pako.min.js</div>
                <div class="panel-body" style="padding: 0">
                    <table class="table table-hover" style="padding: 0;margin-bottom:0px">
                        <thead>
                            <tr>
                                <th>前缀</th>
                                <th>说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>FLY/gz</td>
                                <td>表示该字段由GZip压缩</td>
                            </tr>
                            <tr>
                                <td>实例</td>
                                <td>如字段a值为1 压缩后加上前缀为FLY/gzH4sIAAAAAAAAAzM...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div v-if=" title" class="card col-md-0" style="margin-right: 20px;">
            <!-- <ol class=" breadcrumb">
                <li>{{title}}</li>
                <li class="active">{{selected.title}}</li>
            </ol> -->
            <div class="panel panel-primary" style="margin: 10px;">
                <div class="panel-heading">路由地址：{{selected.api}}</div>
                <div v-if="selected.note" class="panel-body" v-html="selected.note"></div>
            </div>
            <div class="panel panel-danger" style="margin: 10px;">
                <div class="panel-heading">请求方式：{{selected.method}}</div>
            </div>
            <div class="panel panel-success" style="margin: 10px;">
                <div class="panel-heading">请求参数</div>
                <div class="panel-body" style="padding: 0;">
                    <table class="table table-hover" style="margin-bottom:0px">
                        <thead>
                            <tr>
                                <th>参数名</th>
                                <th>类型</th>
                                <th>是否必填</th>
                                <th>说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="p in selected.param">
                                <td>{{p.key}}</td>
                                <td>{{p.type}}</td>
                                <td v-html="p.must"></td>
                                <td v-html="p.note"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="panel panel-info" style="margin: 10px;" v-for="val,key in selected.returns">
                <div class="panel-heading">{{key}}</div>
                <div class="panel-body" v-html="val" style="padding-top: 0px;"></div>
            </div>
        </div>
    </div>
    <script src="/zui/lib/jquery/jquery.js"></script>
    <script src="/zui/js/zui.min.js"></script>
    <script src="/vue.js"></script>
    <script>
        var app = new Vue({
            el: '#docs', data: { docs: undefined, title: undefined, selected: {}, codes: undefined },
            methods: {
                itemClick: function (doc) {
                    app.title = doc.title;
                },
                selectApi: function (title, item) {
                    app.title = title;
                    app.selected = item;
                    item.note = item.note.replace(/\r\n/g, "<br/>");
                    item.param.forEach(p => {
                        p.note = p.note.replace(/\ /g, "<br/>");
                        p.must = "否";
                        item.verify.forEach(v => {
                            if (v == p.key && v.indexOf('.') == -1)
                                return p.must = "<span style='color:red'>是</span>";
                            if (v == p.key || v.startsWith(p.key + '.')) {
                                if (p.must == "否") p.must = "<span style='color:red'>是</span><br/>";
                                p.must += v + "</br>";
                            }
                        });
                    });
                    for (const key in item.returns) item.returns[key] = item.returns[key].replace(/\ /g, "<br/>");
                }
            }
        });
        $.getJSON('/document.json?__debug__=1', message => {
            var docs = message.data;
            app.selectApi(docs[0].title, docs[0].array[0])
            app.docs = docs;
            app.codes = message.codes;
            $('#docs').toggleClass('loading');
            $('#treeMenu').tree({ initialState: 'collapse' });
        });
    </script>
</body>

</html>